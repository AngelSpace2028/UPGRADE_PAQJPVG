exec("""\n#!/usr/bin/env python3\nV=float\nU=ImportError\nS=list\nR=min\nQ=int\nP=all\nO=b'\\x00'\nN=open\nK=input\nJ=print\nI=sum\nF=None\nE=b''\nD=bytearray\nC=bytes\nB=range\nA=len\nimport os,math,random as G\nfrom typing import Optional,List\ntry:import paq as H\nexcept U:H=F\ntry:import zstandard as T;W=T.ZstdCompressor(level=22);X=T.ZstdDecompressor();L=True\nexcept U:L=False\nY='PAQJP_8.2_MULTI_PASS_COMPACT_CORRECTED'\nZ=[A for A in B(2,256)if P(A%B!=0 for B in B(2,Q(A**.5)+1))]\na=[79,17,111]\nclass d:\n	def __init__(A):A.table=[[1,2,1,0],[3,5,0,1],[4,6,2,0],[7,10,0,2],[8,12,3,0],[9,13,1,1],[11,14,0,3],[15,19,4,0],[16,23,2,1],[17,24,2,1],[18,25,2,1],[20,27,1,2],[21,28,1,2],[22,29,1,2],[26,30,0,4],[31,33,5,0],[32,34,3,1],[35,37,1,3],[36,38,1,3],[39,42,0,5],[40,43,4,1],[41,44,2,2],[45,48,1,4],[46,49,1,4],[47,50,1,4],[51,52,0,6],[53,55,6,0],[54,56,4,1],[57,59,2,3],[58,60,2,3],[61,63,0,7],[62,64,5,1],[65,66,3,2],[67,69,1,5],[68,70,1,5],[71,73,0,8],[72,74,6,1],[75,76,4,2],[77,78,2,4],[79,80,2,4],[81,82,0,9],[83,84,7,1],[85,86,5,2],[87,88,3,3],[89,90,1,6],[91,92,0,10],[93,94,8,1],[95,96,6,2],[97,98,4,3],[99,100,2,5],[101,102,0,11],[103,104,9,1],[105,106,7,2],[107,108,5,3],[109,110,3,4],[111,112,1,7],[113,114,0,12],[115,116,10,1],[117,118,8,2],[119,120,6,3],[121,122,4,4],[123,124,2,6],[125,126,0,13],[127,128,11,1],[129,130,9,2],[131,132,7,3],[133,134,5,4],[135,136,3,5],[137,138,1,8],[139,140,0,14],[141,142,12,1],[143,144,10,2],[145,146,8,3],[147,148,6,4],[149,150,4,5],[151,152,2,7],[153,154,0,15],[155,156,13,1],[157,158,11,2],[159,160,9,3],[161,162,7,4],[163,164,5,5],[165,166,3,6],[167,168,1,9],[169,170,0,16],[171,172,14,1],[173,174,12,2],[175,176,10,3],[177,178,8,4],[179,180,6,5],[181,182,4,6],[183,184,2,8],[185,186,0,17],[187,188,15,1],[189,190,13,2],[191,192,11,3],[193,194,9,4],[195,196,7,5],[197,198,5,6],[199,200,3,7],[201,202,1,10],[203,204,0,18],[205,206,16,1],[207,208,14,2],[209,210,12,3],[211,212,10,4],[213,214,8,5],[215,216,6,6],[217,218,4,7],[219,220,2,9],[221,222,0,19],[223,224,17,1],[225,226,15,2],[227,228,13,3],[229,230,11,4],[231,232,9,5],[233,234,7,6],[235,236,5,7],[237,238,3,8],[239,240,1,11],[241,242,0,20],[243,244,18,1],[245,246,16,2],[247,248,14,3],[249,250,12,4],[251,252,10,5],[253,254,8,6],[255,255,6,7]]\ndef M(n):\n	D=0\n	while True:\n		A,C=n-D,n+D\n		if A>=2 and P(A%B!=0 for B in B(2,Q(A**.5)+1)):return A\n		if C>=2 and P(C%A!=0 for A in B(2,Q(C**.5)+1)):return C\n		D+=1\nclass b:\n	def __init__(A):A.PI_DIGITS=a.copy();A.seed_tables=A._gen_seed_tables();A.fibonacci=A._gen_fib(100)\n	def _gen_fib(E,n):\n		C,A=0,1;D=[C,A]\n		for F in B(2,n):C,A=A,C+A;D.append(A)\n		return D\n	def _gen_seed_tables(A,num=126,size=256,seed=42):G.seed(seed);return[[G.randint(5,255)for A in B(size)]for A in B(num)]\n	def get_seed(B,idx,val):\n		if 0<=idx<A(B.seed_tables):return B.seed_tables[idx][val%256]\n		return 0\n	def _append_bits(C,bitlist,value,count):\n		for A in B(count-1,-1,-1):bitlist.append(value>>A&1)\n	def _read_bits(E,bits,pos,count):\n		C=0\n		for D in B(count):\n			if pos+D>=A(bits):return 0\n			C=C<<1|bits[pos+D]\n		return C\n	def transform_00(Y,data):\n		H=data\n		if not H:return O\n		K=F;L=V('inf');M=[];Z=F;a=10;N=D(H);S=[]\n		for c in B(a):\n			P=0;I=N;T=V('-inf')\n			for U in B(256):\n				E=D(N)\n				for W in B(A(E)):E[W]=(E[W]+U)%256\n				Q=0;G=0\n				while G<A(E):\n					b=E[G];R=1;G+=1\n					while G<A(E)and E[G]==b:R+=1;G+=1\n					Q+=R*R\n				if Q>T:T=Q;I=E;P=U\n			S.append(P);J=Y._apply_rle_to_shifted(I,P)\n			if A(J)<L:L=A(J);K=J;M=S.copy();Z=I\n			N=I\n			if A(J)>=A(H):break\n		if K is F or L>=A(H):return C([0])+H\n		X=D([A(M)]);X.extend(M);return X+K\n	def _apply_rle_to_shifted(F,shifted_data,shift):\n		I=shifted_data;E=[];F._append_bits(E,2,3);F._append_bits(E,shift,8);H=0;K=A(I)\n		while H<K:\n			L=I[H];G=1;H+=1\n			while H<K and I[H]==L:G+=1;H+=1\n			if G==1:F._append_bits(E,0,2)\n			elif G<=5:F._append_bits(E,1,2);F._append_bits(E,G-2,2)\n			elif G<=12:F._append_bits(E,2,2);F._append_bits(E,G-6,3)\n			else:F._append_bits(E,15,4);P=R(G,270);F._append_bits(E,P-13,8)\n			F._append_bits(E,L,8)\n		Q=(8-A(E)%8)%8;F._append_bits(E,0,Q);M=D()\n		for N in B(0,A(E),8):\n			J=0\n			for O in B(8):\n				if N+O<A(E):J=J<<1|E[N+O]\n			M.append(J)\n		return C(M)\n	def reverse_transform_00(L,cdata):\n		G=cdata\n		if not G or G==O:return E\n		if G[0]==0:return G[1:]\n		H=G[0]\n		if H==0:return G[1:]\n		if A(G)<1+H:return E\n		M=S(G[1:1+H]);N=G[1+H:];J=L._rle_decode(N)\n		if J is F:return E\n		I=D(J)\n		for P in reversed(M):\n			for K in B(A(I)):I[K]=(I[K]-P)%256\n		return C(I)\n	def _rle_decode(G,data):\n		if not data:return\n		E=[]\n		for L in data:\n			for I in B(7,-1,-1):E.append(L>>I&1)\n		C=0;F=A(E)\n		if F<11:return\n		M=G._read_bits(E,C,3);C+=3\n		if M!=2:return\n		C+=8;K=D()\n		while C+10<=F:\n			if C+2>F:break\n			J=G._read_bits(E,C,2);C+=2\n			if J==0:H=1\n			elif J==1:\n				if C+2>F:break\n				H=2+G._read_bits(E,C,2);C+=2\n			elif J==2:\n				if C+3>F:break\n				H=6+G._read_bits(E,C,3);C+=3\n			else:\n				if C+2>F:break\n				N=G._read_bits(E,C,2)\n				if N!=3:return\n				C+=2\n				if C+8>F:break\n				H=13+G._read_bits(E,C,8);C+=8\n			if C+8>F:break\n			O=G._read_bits(E,C,8);C+=8;K.extend([O]*H)\n		P=F-C\n		if P>7:return\n		for I in B(C,F):\n			if E[I]!=0:return\n		return K\n	def transform_01(I,d,r=100):\n		E=D(d)\n		for F in Z:\n			H=F if F==2 else max(1,math.ceil(F*4096/28672))\n			for J in B(r):\n				for G in B(0,A(E),3):\n					if G<A(E):E[G]^=H\n		return C(E)\n	def reverse_transform_01(A,d,r=100):return A.transform_01(d,r)\n	def transform_02(K,d):\n		if A(d)<1:return E\n		F=D(d);L=I(d)%256;H=(A(d)+L)%256;J=K._get_pattern(4,H)\n		for G in B(1,A(F),4):\n			if G<A(F):F[G]^=J[G%A(J)]\n		return C([H])+C(F)\n	def reverse_transform_02(A,d):return A.transform_02(d)\n	def transform_03(J,d):\n		if A(d)<1:return E\n		F=D(d);G=(A(d)*13+I(d))%8\n		if G==0:G=1\n		for H in B(2,A(F),5):\n			if H<A(F):F[H]=(F[H]<<G|F[H]>>8-G)&255\n		return C([G])+C(F)\n	def reverse_transform_03(I,d):\n		if A(d)<2:return E\n		H=d[0];F=D(d[1:])\n		for G in B(2,A(F),5):\n			if G<A(F):F[G]=(F[G]>>H|F[G]<<8-H)&255\n		return C(F)\n	def transform_04(G,d,r=100):\n		E=D(d)\n		for H in B(r):\n			for F in B(A(E)):E[F]=(E[F]-F%256)%256\n		return C(E)\n	def reverse_transform_04(G,d,r=100):\n		E=D(d)\n		for H in B(r):\n			for F in B(A(E)):E[F]=(E[F]+F%256)%256\n		return C(E)\n	def transform_05(G,d,s=3):\n		E=D(d)\n		for F in B(A(E)):E[F]=(E[F]<<s|E[F]>>8-s)&255\n		return C(E)\n	def reverse_transform_05(G,d,s=3):\n		E=D(d)\n		for F in B(A(E)):E[F]=(E[F]>>s|E[F]<<8-s)&255\n		return C(E)\n	def transform_06(I,d,sd=42):\n		G.seed(sd);F=S(B(256));G.shuffle(F);E=D(d)\n		for H in B(A(E)):E[H]=F[E[H]]\n		return C(E)\n	def reverse_transform_06(J,d,sd=42):\n		G.seed(sd);H=S(B(256));G.shuffle(H);I=[0]*256\n		for E in B(256):I[H[E]]=E\n		F=D(d)\n		for E in B(A(F)):F[E]=I[F[E]]\n		return C(F)\n	def transform_07(G,d,r=100):\n		E=D(d);H=A(d)%A(G.PI_DIGITS);I=G.PI_DIGITS[H:]+G.PI_DIGITS[:H];J=A(d)%256\n		for F in B(A(E)):E[F]^=J\n		for K in B(r):\n			for F in B(A(E)):E[F]^=I[F%A(I)]\n		return C(E)\n	def reverse_transform_07(A,d,r=100):return A.transform_07(d,r)\n	def transform_08(G,d,r=100):\n		E=D(d);H=A(d)%A(G.PI_DIGITS);I=G.PI_DIGITS[H:]+G.PI_DIGITS[:H];J=M(A(d)%256)\n		for F in B(A(E)):E[F]^=J\n		for K in B(r):\n			for F in B(A(E)):E[F]^=I[F%A(I)]\n		return C(E)\n	def reverse_transform_08(A,d,r=100):return A.transform_08(d,r)\n	def transform_09(E,d,r=100):\n		F=D(d);H=A(d)%A(E.PI_DIGITS);I=E.PI_DIGITS[H:]+E.PI_DIGITS[:H];J=M(A(d)%256);K=E.get_seed(A(d)%A(E.seed_tables),A(d))\n		for G in B(A(F)):F[G]^=J^K\n		for L in B(r):\n			for G in B(A(F)):F[G]^=I[G%A(I)]^G%256\n		return C(F)\n	def reverse_transform_09(A,d,r=100):return A.transform_09(d,r)\n	def transform_10(J,d,r=100):\n		G=I(1 for A in B(A(d)-1)if d[A:A+2]==b'X1');F=(G*2+1)//3*3%256;E=D(d)\n		for K in B(r):\n			for H in B(A(E)):E[H]^=F\n		return C([F])+C(E)\n	def reverse_transform_10(I,d,r=100):\n		if A(d)<1:return E\n		G=d[0];F=D(d[1:])\n		for J in B(r):\n			for H in B(A(F)):F[H]^=G\n		return C(F)\n	def transform_11(I,d,r=100):\n		if not d:return E\n		G=D(d);H=A(G)\n		for N in B(r):\n			for F in B(H):J=(F+H)%A(I.fibonacci);K=I.fibonacci[J]%256;L=(F*13+H*17)%256;M=G[F-1]if F>0 else H%256;G[F]=(G[F]^K^L^M)%256\n		return C(G)\n	def reverse_transform_11(A,d,r=100):return A.transform_11(d,r)\n	def transform_12(F,d,r=100):\n		E=D(d)\n		for H in B(r):\n			for G in B(A(E)):E[G]^=F.fibonacci[G%A(F.fibonacci)]%256\n		return C(E)\n	def reverse_transform_12(A,d,r=100):return A.transform_12(d,r)\n	def transform_13(K,d):\n		if not d:return E\n		I=K._calculate_repeats(d);F=A(d)%256;G=[];J=0\n		while J<I:F=M(F);G.append(F);J+=1\n		H=D(d);L=G[-1]if G else 0\n		for N in B(A(H)):H[N]^=L\n		O=(I-1)%256;return C([O])+C(H)\n	def reverse_transform_13(O,d):\n		if A(d)<2:return E\n		K=d[0];G=(K+1)%256\n		if G==0:G=256\n		F=D(d[1:]);H=A(F)%256;I=[];J=0\n		while J<G:H=M(H);I.append(H);J+=1\n		L=I[-1]if I else 0\n		for N in B(A(F)):F[N]^=L\n		return C(F)\n	def transform_14(B,d):\n		if not d:return E\n		A=B._calculate_bits_to_add(d);D=B._add_bits_to_end(d,A)\n		if A>0:return C([A])+D\n		return D\n	def reverse_transform_14(B,d):\n		if A(d)<1:return E\n		if d[0]==0:return d[1:]if A(d)>1 else E\n		C=d[0];D=d[1:];return B._remove_bits_from_end(D,C)\n	def transform_15(J,d):\n		if A(d)<1:return E\n		F=D(d);H=A(d)%256;I=J._get_pattern(3,H)\n		for G in B(0,A(F),3):\n			if G<A(F):F[G]=(F[G]+I[G%A(I)])%256\n		return C([H])+C(F)\n	def reverse_transform_15(I,d):\n		if A(d)<2:return E\n		J=d[0];F=D(d[1:]);H=I._get_pattern(3,J)\n		for G in B(0,A(F),3):\n			if G<A(F):F[G]=(F[G]-H[G%A(H)])%256\n		return C(F)\n	def _calculate_bits_to_add(G,data):\n		B=data\n		if not B:return 0\n		C=A(B);D=B[0];E=B[-1];F=I(B)%256;return(C*13+D*17+E*23+F*29)%9\n	def _add_bits_to_end(G,data,bits_count):\n		B=bits_count;A=data\n		if B==0:return A\n		if not A:A=O\n		D=A[-1];E=D&(1<<B)-1;F=(B&15)<<4|E&15;return A+C([F])\n	def _remove_bits_from_end(D,data_with_bits,bits_count):\n		B=data_with_bits\n		if bits_count==0 or not B:return B\n		C=B[:-1]\n		if C==O and A(B)==2:return E\n		return C\n	def _get_pattern(A,size,index):G.seed(12345+size*100+index);return[G.randint(0,255)for A in B(size)]\n	def _calculate_repeats(F,data):\n		B=data\n		if not B:return 1\n		C=A(B);D=I(B)%256;E=(C*13+D*17)%256+1;return max(1,R(256,E))\n	def _dynamic_transform(H,n):\n		def F(data):\n			F=data\n			if not F:return E\n			I=H.get_seed(n%A(H.seed_tables),A(F));G=D(F)\n			for J in B(A(G)):G[J]^=I\n			return C(G)\n		return F,F\n	def _compress_backend(G,data):\n		B=[]\n		if H is not F:B.append((b'L',H.compress(data)))\n		if L:B.append((b'Z',W.compress(data)))\n		if not B:return E\n		C,D=R(B,key=lambda x:A(x[1]));return C+D\n	def _decompress_backend(E,data):\n		B=data\n		if A(B)<1:return\n		C=B[0];D=B[1:]\n		if C==ord('L')and H is not F:\n			try:return H.decompress(D)\n			except:return\n		if C==ord('Z')and L:\n			try:return X.decompress(D)\n			except:return\n	def compress_with_best(D,data):\n		E=data\n		if not E:return C([0])\n		F=D._compress_backend(E);G=A(F);H=255;K=[(0,D.transform_00),(1,D.transform_01),(2,D.transform_02),(3,D.transform_03),(4,D.transform_04),(5,D.transform_05),(6,D.transform_06),(7,D.transform_07),(8,D.transform_08),(9,D.transform_09),(10,D.transform_10),(11,D.transform_11),(12,D.transform_12),(13,D.transform_13),(14,D.transform_14),(15,D.transform_15)]+[(A,D._dynamic_transform(A)[0])for A in B(16,256)]\n		for(L,M)in K:\n			try:\n				N=M(E);I=D._compress_backend(N);J=A(I)\n				if J<G:G=J;F=I;H=L\n			except Exception:continue\n		return C([H])+F\n	def decompress_with_best(C,data):\n		D=data\n		if A(D)<2:return E,F\n		G=D[0];K=D[1:];H=C._decompress_backend(K)\n		if H is F:return E,F\n		I={0:C.reverse_transform_00,1:C.reverse_transform_01,2:C.reverse_transform_02,3:C.reverse_transform_03,4:C.reverse_transform_04,5:C.reverse_transform_05,6:C.reverse_transform_06,7:C.reverse_transform_07,8:C.reverse_transform_08,9:C.reverse_transform_09,10:C.reverse_transform_10,11:C.reverse_transform_11,12:C.reverse_transform_12,13:C.reverse_transform_13,14:C.reverse_transform_14,15:C.reverse_transform_15,255:lambda x:x}\n		for J in B(16,256):I[J]=C._dynamic_transform(J)[1]\n		L=I.get(G,lambda x:x);return L(H),G\n	def compress(F,infile,outfile):\n		E=outfile\n		with N(infile,'rb')as C:B=C.read()\n		D=F.compress_with_best(B)\n		with N(E,'wb')as C:C.write(D)\n		G=(1-A(D)/A(B))*100 if B else 0;I=' (zstd)'if L else' (paq only)'if H else' (no backend!)';J(f"Compressed {A(B)} → {A(D)} bytes ({G:.2f}% saved){I} → {E}")\n	def decompress(G,infile,outfile):\n		D=outfile\n		with N(infile,'rb')as C:H=C.read()\n		B,I=G.decompress_with_best(H)\n		if B is F or B==E:J('Decompression failed!');return\n		with N(D,'wb')as C:C.write(B)\n		J(f"Decompressed (transform {I}) → {D} ({A(B)} bytes)")\ndef c():\n	E='Output file: ';J(f"{Y} – multi-pass compact RLE transform 0 (lossless corrected)");C=b();D=K('1) Compress   2) Decompress\\n> ').strip()\n	if D=='1':A=K('Input file: ').strip();B=K(E).strip()or A+'.pjp';C.compress(A,B)\n	elif D=='2':A=K('Compressed file: ').strip();B=K(E).strip()or A.rsplit('.',1)[0]+'.orig';C.decompress(A,B)\n	else:J('Invalid choice.')\nif __name__=='__main__':c()\n""")
